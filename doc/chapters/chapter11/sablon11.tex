% Szglab4
% ===========================================================================
%
\chapter{Grafikus felület specifikációja}

\thispagestyle{fancy}

\section{A grafikus interfész}
%\comment{A menürendszer, a kezelői felület grafikus képe. A grafikus felület megjelenését, a használt ikonokat, stb screenshot-szerű képekkel kell bemutatni. Az építészetben ez a homlokzati terv.}
A szoftvert elindítva megjelenik egy grafikus ablak a következő tartalommal:

\begin{figure}[H]
\begin{center}
\includegraphics[width=10cm]{images/ch11/screenshot_menu.png}
\caption{A menü kinézete}
\label{fig:screenshot_menu}
\end{center}
\end{figure}

Értelemszerűen a bal oldali listában az elérhető pályák közül választhatja ki a felhasználó azt, amelyiken játszani szeretne, a jobb oldaliban pedig a kiválasztott pályához tartozó missziók közül azt, amelyiket el kívánja indítani.

Az alul látható gombok közül a "Kilépés" feliratú bezárja az alkalmazást, a "Játék indítása" feliratú pedig a fent kijelölt paraméterekkel elindítja a játékot. Ekkor az ablak átméreteződik, tartalma kicserélődik erre:

\begin{figure}[H]
\begin{center}
\includegraphics[width=14cm]{images/ch11/screenshot_game.png}
\caption{A játék képe}
\label{fig:screenshot_game}
\end{center}
\end{figure}

Az ablak felső részében a menüsáv, alatta pedig a játéktér foglal helyet.

A menüsávban lévő kis ikonok segítségével a következő funkciók érhetők el (balról jobbra haladva):

\begin{itemize}
\item Torony ikon: Először erre, majd a játéktéren egy megfelelő helyre (nem útra) kattintva egy torony építhető
\item Piros, zöld és kék varázskő ikonok: Először ezekre, majd a játéktéren egy toronyra kattintva egy torony erősíthető a kiválasztott varázskővel
\item Akadály ikon: Először erre, majd a játéktéren egy megfelelő helyre (útra) kattintva egy akadály építhető
\item Sárga és narancssárga varázskő ikonok: Először ezekre, majd a játéktéren egy akadályra kattintva egy akadály erősíthető a kiválasztott varázskővel
\end{itemize}

A menüsáv jobb szélén pedig a jelenleg rendelkezésre álló varázserőnket olvashatjuk le.\\
\\
Ahogyan a fenti ábrán is látszik, az egérmutatót a varázskő ikonokon tartva egy felugró eszköztipp ablakban megjelenik néhány sor szöveg, amely leírja a kiválasztott varázskő nevét, tulajdonságait, és varázserőben mért árát.\\
\\
A játéktér jeleníti meg a csata pillanatnyi állapotát. A barna vonalak az ellenség útvonalai, amelyeken az ablak jobb szélen látható Végzet Hegye felé tartanak.\\
\\
Az egyes ellenségeket különbözű színű háromszögek szimbolizálják. A sötétebb narancssárga embert, a halványrózsaszín hobbitot, a zöld tündét, a szürke pedig törpöt jelent.\\
\\
A tornyok magától értetődő ábrával jelennek meg, az akadályok az utakon pedig egy három szikladarabot ábrázoló kép formájában.\\
\\
Azon tornyok és akadályok képe fölött, amelyek már meg lettek erősítve varázskővel, a rajtuk lévő kő ikonja megjelenik a jobb felső sarokban.\\
\\
A tornyok által az ellenségekre kilőtt lövedékek a fekete, míg a különleges, kettévágó lövedékek a piros golyók.\\
\\
Az alkalmanként leszálló köd az egész játékteret beborító halvány, szürkés átfedés formájában fog megjelenni.\\
\\
Összefoglaló áttekintés a játéktér ikonjairól (nem méretarányosan):

\begin{figure}[ht]
\centering

\subfigure[Torony]{
\includegraphics[width=2cm]{images/ch11/icons/tower.png}
    \label{overview:tower}
}
\subfigure[Akadály]{
\includegraphics[width=2cm]{images/ch11/icons/obstacle.png}
    \label{overview:obstacle}
}
\subfigure[Varázskő]{
\includegraphics[width=2cm]{images/ch11/icons/blue_gem.png}
    \label{overview:gem}
}
\subfigure[Ellenség]{
\includegraphics[width=2cm]{images/ch11/icons/human.png}
    \label{overview:enemy}
}
\subfigure[Lövedék]{
\includegraphics[width=2cm]{images/ch11/icons/projectile.png}
    \label{overview:projectile}
}
\subfigure[Kettévágó lövedék]{
\includegraphics[width=2cm]{images/ch11/icons/splitter_projectile.png}
    \label{overview:splitter_projectile}
}
\caption{Áttekintés az ikonokról}
\label{fig:icon_overview}
\end{figure}

\newpage

\section{A grafikus rendszer architektúrája}
%\comment{A felület működésének elve, a grafikus rendszer architektúrája (struktúra diagramok). A struktúra diagramokon a prototípus azon és csak azon osztályainak is szerepelnie kell, amelyekhez a grafikus felületet létrehozó osztályok kapcsolódnak.}

\subsection{A felület működési elve}
A grafikus felületet MVC architektúrának megfelelően próbáltuk megtervezni. Minden képernyőn megjelenő objektumnak van egy grafikus párja, ami megvalósítja a \textbf{Drawable} interfészt. A \textbf{View} osztály ilyen objektumokat tárol, és minden kirajzolásnál meghívja ezen objektumok draw metódusát. \\
A megjelenítés push alapú. Ha a modelben történt valami változás (amit hívhatunk egy eseménynek), akkor értesíti a \textbf{View}-t, hogy valami esemény történt, úgy hogy meghívja az eseménynek megfelelő metódust. Kirajzolásnál minden grafikus objektum, lekérdezi a \textbf{Game}-ben lévő párjától az adatait, majd ez alapján kirajzolja magát.\\
Az MVC megvalósítás alól kivételt képez a program indulása, amikor is egy egyszerű menü jelenik, amin el lehet indítani a játékot, ezt a \textbf{Menu} osztály végzi.\\
A \textbf{Controller} osztály a program elején, a \textbf{Game} és \textbf{View} objektumok létrehozása után feliratkozik a neki megfelelő eseményekre. Ez után már fogadja is az eseményeket.\\
Tervezés során ügyletünk arra is, hogy könnyen bővíthető, cserélhető legyen a rendszer. A \textbf{View} és \textbf{Graphic} osztályokból való származtatással új GUI-t lehet készíteni, anélkül, hogy meglévő kódban kelljen (sokat) változtatni.

\subsection{A felület osztály-struktúrája}
%\comment{Osztálydiagram. Minden új osztály, és azon régiek, akik az újakhoz közvetlenül kapcsolódnak.}

\begin{figure}[H]
\begin{center}
\includegraphics[width=18cm]{images/ch11/very_uml_class_tiny.png}
\caption{Grafikus felület osztálydigaramja}
\label{fig:Graphic_class_diag}
\end{center}
\end{figure}

\section{A grafikus objektumok felsorolása}
%\comment{Az új osztályok felsorolása. Az régi osztályok közül azoknak a felsorolása, ahol változás volt. Ezek esetén csak a változásokat kell leírni.}

\subsection{Window}
\begin{itemize}
\item Felelősség\newline
A játék fő ablaka, ez jeleníti meg a menüt és aztán magát a játékot.
\item Ősosztályok\newline
JFrame
\item Attribútumok\newline
	\begin{itemize}
		\item - menu: Menu: A játék menü objektumát tárolja.
		\item - game: Game: A játék Game objektumát tárolja.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item + setGame(Game): Beállítja azt a Game objektumot, amit a kezelőfelület meg fog jeleníteni. A menü fogja meghívni a pálya- és misszióválasztás után.
	\end{itemize}
\end{itemize}

\subsection{Menu}
\begin{itemize}
\item Felelősség\newline
A játék főmenüjét valósítja meg, amivel új játékot lehet indítani, ezen belül kiválasztani a pályát és a missziót.
\item Attribútumok\newline
	\begin{itemize}
		\item \# panel: JPanel: A menü kirajzolásához használt JPanel.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item + exit(): Bezárja a játék ablakait, és kilép a programból.
		\item + newGame(): Új játék indítását kezdeményezi.
	\end{itemize}
\end{itemize}

\subsection{View}
\begin{itemize}
\item Felelősség\newline
A játék kirajzolása, azaz a Game osztály állapotának megjelenítésa a képernyőn.
\item Attribútumok\newline
	\begin{itemize}
		\item \# panel: JPanel: A játék kirajzolásához használt JPanel
		\item \# drawables: List<Drawable>: A játékban kirajzolandó dolgok (ellenségek, tornyok, stb.) listája.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item + drawAll(): Kirajzolja a játék jelenlegi állását.
		\item + enemyAdded(Enemy): A Game hívja meg amikor új ellenség kerül a pályára, frissíti a View adatstruktúráit.
		\item + enemyDied(Enemy): A Game hívja meg amikor meghal egy ellenség, frissíti a View adatstruktúráit.
		\item + obstacleAdded(Obstacle): A Game hívja meg amikor új akadály kerül a pályára, frissíti a View adatstruktúráit.
		\item + towerAdded(Tower): A Game hívja meg amikor új torony kerül a pályára, frissíti a View adatstruktúráit.
		\item + projectileAdded(Projectile): A Game hívja meg amikor új lövedék kerül a pályára, frissíti a View adatstruktúráit.
		\item + projectileExploded(Projectile): A Game hívja meg amikor egy lövedék megsemmisül, frissíti a View adatstruktúráit.
	\end{itemize}
\end{itemize}

\subsection{Controller}
\begin{itemize}
\item Felelősség\newline
A játék futása közben a felhasználótól érkező eseményeket kezeli, és értesíti róluk a Game-et. Az egyes események kezelését továbbadja a benne lévő eseménykezelő osztályoknak.
\item Attribútumok\newline
	\begin{itemize}
		\item - game: Game: A kontrollerhez tartozó Game onjektum.
	\end{itemize}
\end{itemize}

\subsection{MouseEventHandler}
\begin{itemize}
\item Felelősség\newline
Az egérkattintás eseményeket kezeli le.
\item Interfészek\newline
MouseListener
\item Metódusok\newline
	\begin{itemize}
		\item + MouseClicked(MouseEvent): Egérkattintáskor hívódik meg, kezeli az eseményt.
	\end{itemize}
\end{itemize}

\subsection{Drawable}
\begin{itemize}
\item Felelősség\newline
Közös interfészt nyújt a játékban az összes kirajzolható objektumnak.
\item Interfészek\newline
Comparable<Drawable>
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja az objektumot.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\subsection{GraphicEnemy}
\begin{itemize}
\item Felelősség\newline
Egy ellenség kirajzolása.
\item Interfészek\newline
Comparable<Drawable> $\rightarrow$ Drawable
\item Attribútumok\newline
	\begin{itemize}
		\item \# img: Image: A kirajzolandó ellenség képe.
		\item \# z\_index: int: A kirajzolandó ellenség mélységi elhelyezkedése.
		\item \# enemy: Enemy: A kirajzolandó ellenség.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja az ellenséget.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\subsection{GraphicFog}
\begin{itemize}
\item Felelősség\newline
A köd kirajzolása.
\item Interfészek\newline
Comparable<Drawable> $\rightarrow$ Drawable
\item Attribútumok\newline
	\begin{itemize}
		\item \# img: Image: A köd képe.
		\item \# z\_index: int: A köd mélységi elhelyezkedése.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja a ködöt.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\subsection{GraphicTower}
\begin{itemize}
\item Felelősség\newline
Egy torony kirajzolása.
\item Interfészek\newline
Comparable<Drawable> $\rightarrow$ Drawable
\item Attribútumok\newline
	\begin{itemize}
		\item \# img: Image: A kirajzolandó torony képe.
		\item \# z\_index: int: A kirajzolandó torony mélységi elhelyezkedése.
		\item \# tower: Tower: A kirajzolandó torony.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja a tornyot.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\subsection{GraphicMap}
\begin{itemize}
\item Felelősség\newline
A pálya kirajzolása.
\item Interfészek\newline
Comparable<Drawable> $\rightarrow$ Drawable
\item Attribútumok\newline
	\begin{itemize}
		\item \# img: Image: A pálya háttérképe.
		\item \# z\_index: int: A pálya háttérképének mélységi elhelyezkedése.
		\item \# map: Map: A kirajzolandó pálya.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja a pályát.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\subsection{GraphicObstacle}
\begin{itemize}
\item Felelősség\newline
Egy akadály kirajzolása.
\item Interfészek\newline
Comparable<Drawable> $\rightarrow$ Drawable
\item Attribútumok\newline
	\begin{itemize}
		\item \# img: Image: A kirajzolandó akadály képe.
		\item \# z\_index: int: A kirajzolandó akadály mélységi elhelyezkedése.
		\item \# obstacle: Obstacle: A kirajzolandó akadály.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja az akadályt.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\subsection{GraphicProjectile}
\begin{itemize}
\item Felelősség\newline
Egy lövedék kirajzolása.
\item Interfészek\newline
Comparable<Drawable> $\rightarrow$ Drawable
\item Attribútumok\newline
	\begin{itemize}
		\item \# img: Image: A kirajzolandó lövedék képe.
		\item \# z\_index: int: A kirajzolandó lövedék mélységi elhelyezkedése.
		\item \# projectile: Projectile: A kirajzolandó lövedék.
	\end{itemize}
\item Metódusok\newline
	\begin{itemize}
		\item draw(): Kirajzolja a lövedéket.
		\item compareTo(Drawable): Z-index szerint hasonlít össze két Drawable-t.
	\end{itemize}
\end{itemize}

\section{Kapcsolat az alkalmazói rendszerrel}
\comment{Szekvencia-diagramokon ábrázolni kell a grafikus rendszer működését. Konzisztens kell legyen az előző alfejezetekkel. Minden metódus, ami ott szerepel, fel kell tűnjön valamelyik szekvenciában. Minden metódusnak, ami szekvenciában szerepel, szereplnie kell a valamelyik osztálydiagramon.}

